<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control Panel</title>
    <style>
        body { background-color: #121212; color: #00ff99; font-family: 'Courier New', monospace; text-align: center; padding: 20px; }
        .container { max-width: 500px; margin: 0 auto; background: #1e1e1e; padding: 20px; border-radius: 10px; }
        input { width: 90%; padding: 12px; margin: 10px 0; background: #333; border: 1px solid #00ff99; color: white; border-radius: 5px; }
        button { width: 100%; padding: 15px; border: none; border-radius: 5px; cursor: pointer; font-size: 18px; font-weight: bold; margin-top: 10px; }
        .btn-create { background: #00ff99; color: black; }
        .btn-scare { background: #ff0055; color: white; height: 100px; font-size: 24px; display: none; }
        #link-box { display: none; margin-top: 20px; color: white; word-break: break-all; border: 1px dashed #555; padding: 10px;}
    </style>
</head>
<body>
    <div class="container">
        <h1 id="txt-title">PRANK MASTER</h1>
        
        <div id="setup-step">
            <input type="text" id="imgUrl" placeholder="Image URL">
            <input type="text" id="sndUrl" placeholder="Sound URL" value="https://www.myinstants.com/media/sounds/scream.mp3">
            <button id="btn-gen" class="btn-create" onclick="createLink()">GENERATE LINK</button>
        </div>

        <div id="link-box">
            <p id="txt-send" style="color: #aaa;">Send this to victim:</p>
            <a id="victim-link" href="#" target="_blank" style="color: #4db8ff;">...</a>
        </div>

        <button id="btn-scare" class="btn-scare" onclick="trigger()">SCARE NOW!</button>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        // --- –ë–õ–û–ö –ü–ï–†–ï–ö–õ–ê–î–£ ---
        const langData = {
            'uk': {
                title: "–ú–ê–ô–°–¢–ï–† –ü–†–ê–ù–ö–Ü–í üíÄ",
                ph_img: "URL –ö–∞—Ä—Ç–∏–Ω–∫–∏ (–Ω–µ –æ–±–æ–≤'—è–∑–∫–æ–≤–æ)",
                ph_snd: "URL –ó–≤—É–∫—É (.mp3)",
                btn_gen: "–ó–ì–ï–ù–ï–†–£–í–ê–¢–ò –ü–û–°–ò–õ–ê–ù–ù–Ø",
                txt_send: "–ù–∞–¥—ñ—à–ª–∏ —Ü–µ –∂–µ—Ä—Ç–≤—ñ:",
                btn_scare: "–ù–ê–õ–Ø–ö–ê–¢–ò !!!"
            },
            'ru': {
                title: "–ú–ê–°–¢–ï–† –ü–†–ê–ù–ö–û–í üíÄ",
                ph_img: "URL –ö–∞—Ä—Ç–∏–Ω–∫–∏ (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)",
                ph_snd: "URL –ó–≤—É–∫–∞ (.mp3)",
                btn_gen: "–°–û–ó–î–ê–¢–¨ –°–°–´–õ–ö–£",
                txt_send: "–û—Ç–ø—Ä–∞–≤—å —ç—Ç–æ –∂–µ—Ä—Ç–≤–µ:",
                btn_scare: "–ù–ê–ü–£–ì–ê–¢–¨ !!!"
            },
            'en': { // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞
                title: "PRANK MASTER üíÄ",
                ph_img: "Image URL (Optional)",
                ph_snd: "Sound URL (.mp3)",
                btn_gen: "GENERATE LINK",
                txt_send: "Send this to victim:",
                btn_scare: "SCARE NOW !!!"
            }
        };

        // –í–∏–∑–Ω–∞—á–∞—î–º–æ –º–æ–≤—É (–±–µ—Ä–µ–º–æ –ø–µ—Ä—à—ñ 2 –ª—ñ—Ç–µ—Ä–∏: uk-UA -> uk)
        const userLang = navigator.language.slice(0, 2); 
        const t = langData[userLang] || langData['en']; // –Ø–∫—â–æ –º–æ–≤–∏ –Ω–µ–º–∞—î, –±–µ—Ä–µ–º–æ –∞–Ω–≥–ª

        // –ó–∞—Å—Ç–æ—Å–æ–≤—É—î–º–æ —Ç–µ–∫—Å—Ç
        document.getElementById('txt-title').innerText = t.title;
        document.getElementById('imgUrl').placeholder = t.ph_img;
        document.getElementById('sndUrl').placeholder = t.ph_snd;
        document.getElementById('btn-gen').innerText = t.btn_gen;
        document.getElementById('txt-send').innerText = t.txt_send;
        document.getElementById('btn-scare').innerText = t.btn_scare;

        // --- –õ–û–ì–Ü–ö–ê –ü–†–ê–ù–ö–£ ---
        const socket = io();
        let currentSessionId = null;

        async function createLink() {
            const image = document.getElementById('imgUrl').value;
            const sound = document.getElementById('sndUrl').value;
            if(!sound) return alert("URL sound error");

            const res = await fetch('/create', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ image, sound })
            });
            const data = await res.json();
            currentSessionId = data.id;

            const link = `${window.location.origin}/victim.html?id=${currentSessionId}`;
            
            document.getElementById('link-box').style.display = 'block';
            document.getElementById('victim-link').href = link;
            document.getElementById('victim-link').innerText = link;
            document.getElementById('btn-scare').style.display = 'block';
            document.getElementById('setup-step').style.display = 'none';

            socket.emit('join-room', currentSessionId);
        }

        function trigger() {
            if(currentSessionId) socket.emit('trigger-scare', currentSessionId);
        }
    </script>
</body>
</html>