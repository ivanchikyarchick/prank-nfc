[file name]: server.js
[file content begin]
const express = require('express');
const app = express();
const http = require('http').createServer(app);
const io = require('socket.io')(http);
const { v4: uuidv4 } = require('uuid');
const fs = require('fs');
const path = require('path');
const { GoogleGenerativeAI } = require('@google/generative-ai');

// –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è Gemini AI
const genAI = new GoogleGenerativeAI('AIzaSyB5bJTgHWd0zmsO95fESuaqzjTAeP-2oEE');
const model = genAI.getGenerativeModel({ model: 'gemini-1.5-flash' });

app.use(express.static('public'));
app.use(express.json());

app.get('/', (req, res) => res.redirect('/admin.html'));

const sessions = {};
const activeVictims = {};
const generatedSites = {};

// ... (—ñ–Ω—à—ñ –º–∞—Ä—à—Ä—É—Ç–∏ –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –±–µ–∑ –∑–º—ñ–Ω) ...

// AI –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è HTML —Å–∞–π—Ç—É –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º Gemini
app.post('/generate-site', async (req, res) => {
    try {
        const { theme, soundUrl } = req.body;
        
        if (!theme || theme.trim().length < 3) {
            return res.status(400).json({ error: '–¢–µ–º–∞ –ø–æ–≤–∏–Ω–Ω–∞ –º—ñ—Å—Ç–∏—Ç–∏ –ø—Ä–∏–Ω–∞–π–º–Ω—ñ 3 —Å–∏–º–≤–æ–ª–∏' });
        }

        console.log(`Generating AI site for theme: ${theme}`);
        
        const siteId = uuidv4().split('-').slice(0, 3).join('-');
        const fileName = `cust_${siteId}.html`;
        const filePath = path.join(__dirname, 'public', fileName);
        
        // –ì–µ–Ω–µ—Ä—É—î–º–æ HTML –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Gemini AI
        const prompt = `
            –°—Ç–≤–æ—Ä–∏ HTML —Å—Ç–æ—Ä—ñ–Ω–∫—É –¥–ª—è –∂–∞—Ä—Ç—ñ–≤–ª–∏–≤–æ—ó –ø–∞—Å—Ç–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ç–µ–º–∏: "${theme}".
            
            –í–∏–º–æ–≥–∏:
            1. –¢–µ–º–∞—Ç–∏–∫–∞: ${theme}
            2. ${soundUrl ? `–î–æ–¥–∞–π –∑–≤—É–∫ –∑ URL: ${soundUrl}` : '–ë–µ–∑ –∑–≤—É–∫—É'}
            3. –°—Ç–∏–ª—å: —Ç–µ–º–Ω–∞ —Ç–µ–º–∞, –º—ñ–Ω—ñ–º–∞–ª—ñ—Å—Ç–∏—á–Ω–∏–π –¥–∏–∑–∞–π–Ω
            4. –ú—ñ—Å—Ç–∏—Ç—å: –∑–∞–≥–æ–ª–æ–≤–æ–∫, –æ–ø–∏—Å —Ç–µ–º–∏, –µ–ª–µ–º–µ–Ω—Ç–∏ –≤–∑–∞—î–º–æ–¥—ñ—ó
            5. –î–æ–¥–∞–π –∫—Ä–µ–∞—Ç–∏–≤–Ω—ñ –∞–Ω—ñ–º–∞—Ü—ñ—ó —Ç–∞ –µ—Ñ–µ–∫—Ç–∏
            6. –í–∫–ª—é—á–∏ JavaScript –¥–ª—è –¥–∏–Ω–∞–º—ñ—á–Ω–∏—Ö –µ—Ñ–µ–∫—Ç—ñ–≤
            7. –ê–¥–∞–ø—Ç–∏–≤–Ω–∏–π –¥–∏–∑–∞–π–Ω –¥–ª—è –º–æ–±—ñ–ª—å–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤
            8. –ö–æ–ª—å–æ—Ä–∏ –ø–æ–≤–∏–Ω–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ —Ç–µ–º—ñ
            9. –î–æ–¥–∞–π –µ–ª–µ–º–µ–Ω—Ç–∏ –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω–∫–∏ (—Å—é—Ä–ø—Ä–∏–∑–∏)
            
            –°—Ç—Ä—É–∫—Ç—É—Ä–∞ HTML:
            - –ü–æ–≤–Ω–∏–π HTML –¥–æ–∫—É–º–µ–Ω—Ç –∑ DOCTYPE
            - –°—Ç–∏–ª—ñ –≤ —Ç–µ–≥—É <style>
            - JavaScript –≤ –∫—ñ–Ω—Ü—ñ —Ç—ñ–ª–∞
            - –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π —Å—É—á–∞—Å–Ω—ñ CSS –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ
            - –î–æ–¥–∞–π —ñ–∫–æ–Ω–∫–∏ —Ç–∞ –µ–º–æ–¥–∑—ñ –¥–ª—è –Ω–∞–æ—á–Ω–æ—Å—Ç—ñ
            
            –û–±–æ–≤'—è–∑–∫–æ–≤–æ –≤–∫–ª—é—á–∏:
            1. –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è-–∑–∞–≥–ª—É—à–∫—É –∞–±–æ CSS –≥—Ä–∞–¥—ñ—î–Ω—Ç
            2. –ö–Ω–æ–ø–∫–∏ –∞–±–æ –æ–±–ª–∞—Å—Ç—ñ –¥–ª—è –∫–ª—ñ–∫—É
            3. –¢–∞–π–º–µ—Ä –∞–±–æ –∞–Ω—ñ–º–∞—Ü—ñ—ó
            4. –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —â–æ –∑'—è–≤–ª—è—é—Ç—å—Å—è
            5. –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–≤—É–∫—É (—è–∫—â–æ —î URL)
            
            –í–∏–≤–µ–¥–∏ –¢–Ü–õ–¨–ö–ò HTML –∫–æ–¥ –±–µ–∑ –ø–æ—è—Å–Ω–µ–Ω—å.
        `;

        try {
            const result = await model.generateContent(prompt);
            const aiResponse = result.response.text();
            
            // –û—á–∏—â–∞—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –≤—ñ–¥ markdown –∫–æ–¥—É
            let htmlContent = aiResponse
                .replace(/```html\n/g, '')
                .replace(/```\n/g, '')
                .replace(/```/g, '')
                .trim();
            
            // –Ø–∫—â–æ Gemini –Ω–µ –ø–æ–≤–µ—Ä–Ω—É–≤ –∫–æ—Ä–µ–∫—Ç–Ω–∏–π HTML, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ fallback
            if (!htmlContent.includes('<!DOCTYPE html>') && !htmlContent.includes('<html>')) {
                console.log('Gemini returned non-HTML, using fallback');
                htmlContent = generateFallbackHTML(theme, soundUrl);
            }
            
            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —Ñ–∞–π–ª
            fs.writeFileSync(filePath, htmlContent, 'utf8');
            
            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Å–∞–π—Ç
            generatedSites[siteId] = {
                id: siteId,
                theme: theme,
                soundUrl: soundUrl || '',
                fileName: fileName,
                createdAt: new Date().toLocaleString('uk-UA'),
                url: `/cust.html/${siteId}`,
                generatedBy: 'Gemini AI'
            };
            
            console.log(`AI site generated by Gemini: ${siteId} - ${theme}`);
            
            res.json({ 
                success: true, 
                siteId: siteId,
                url: `/cust.html/${siteId}`,
                directUrl: `${req.protocol}://${req.get('host')}/cust.html/${siteId}`,
                generatedBy: 'Gemini AI'
            });
            
        } catch (aiError) {
            console.error('Gemini AI error:', aiError);
            // Fallback –Ω–∞ –±–∞–∑–æ–≤–∏–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
            const htmlContent = generateFallbackHTML(theme, soundUrl);
            fs.writeFileSync(filePath, htmlContent, 'utf8');
            
            generatedSites[siteId] = {
                id: siteId,
                theme: theme,
                soundUrl: soundUrl || '',
                fileName: fileName,
                createdAt: new Date().toLocaleString('uk-UA'),
                url: `/cust.html/${siteId}`,
                generatedBy: 'Fallback Generator'
            };
            
            res.json({ 
                success: true, 
                siteId: siteId,
                url: `/cust.html/${siteId}`,
                directUrl: `${req.protocol}://${req.get('host')}/cust.html/${siteId}`,
                generatedBy: 'Fallback (Gemini failed)'
            });
        }
        
    } catch (error) {
        console.error('Error generating site:', error);
        res.status(500).json({ error: '–ü–æ–º–∏–ª–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Å–∞–π—Ç—É: ' + error.message });
    }
});

// Fallback –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä HTML (—è–∫—â–æ Gemini –Ω–µ –ø—Ä–∞—Ü—é—î)
function generateFallbackHTML(theme, soundUrl) {
    const themes = {
        '–∂–∞—Ö–∏': { bg: '#0a0a0c', color: '#ff0055', title: 'üëª –ñ–∞—Ö–ª–∏–≤–∞ –ø–∞—Å—Ç–∫–∞', emoji: 'üëπ' },
        '–∫–æ–º–µ–¥—ñ—è': { bg: '#1a0033', color: '#ffcc00', title: 'ü§£ –°–º—ñ—à–Ω–∏–π —Å—é—Ä–ø—Ä–∏–∑', emoji: 'ü§°' },
        '–º—ñ—Å—Ç–∏–∫–∞': { bg: '#1a1a2e', color: '#9d00ff', title: 'üîÆ –¢–∞—î–º–Ω–∏—á–∞ –ø–∞—Å—Ç–∫–∞', emoji: 'üåô' },
        '—Ç–µ—Ö–Ω–æ': { bg: '#001122', color: '#00ffff', title: 'ü§ñ –¢–µ—Ö–Ω–æ-–ª–æ–≤—É—à–∫–∞', emoji: '‚ö°' },
        '–ø—Ä–∏—Ä–æ–¥–∞': { bg: '#003311', color: '#00ff99', title: 'üåø –ü—Ä–∏—Ä–æ–¥–Ω–∏–π —Å—é—Ä–ø—Ä–∏–∑', emoji: 'üçÉ' },
        '–º—É–∑–∏–∫–∞': { bg: '#330033', color: '#ff66ff', title: 'üéµ –ú—É–∑–∏—á–Ω–∞ –ø–∞—Å—Ç–∫–∞', emoji: 'üé∂' },
        '–∫–æ—Å–º–æ—Å': { bg: '#000033', color: '#8888ff', title: 'üöÄ –ö–æ—Å–º—ñ—á–Ω–∞ –ø—Ä–∏–≥–æ–¥–∞', emoji: 'üåå' },
        '—Å–ø–æ—Ä—Ç': { bg: '#330000', color: '#ff4444', title: 'üèÜ –°–ø–æ—Ä—Ç–∏–≤–Ω–∏–π –≤–∏–∫–ª–∏–∫', emoji: '‚öΩ' }
    };

    let selectedTheme = themes['—Ç–µ—Ö–Ω–æ'];
    for (const [key, value] of Object.entries(themes)) {
        if (theme.toLowerCase().includes(key)) {
            selectedTheme = value;
            break;
        }
    }

    return `
<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${selectedTheme.title} - AI Generated</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: ${selectedTheme.bg};
            color: white;
            font-family: 'Segoe UI', Arial, sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
            overflow-x: hidden;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(255,255,255,0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255,255,255,0.03) 0%, transparent 50%);
        }
        
        .container {
            max-width: 800px;
            width: 100%;
            padding: 40px;
            animation: fadeIn 1.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .ai-badge {
            background: rgba(157, 0, 255, 0.2);
            border: 1px solid var(--ai-color, #9d00ff);
            color: var(--ai-color, #9d00ff);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            display: inline-block;
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        h1 {
            font-size: 3em;
            color: ${selectedTheme.color};
            margin-bottom: 20px;
            text-shadow: 0 0 15px ${selectedTheme.color}80;
            animation: glow 3s infinite alternate;
        }
        
        @keyframes glow {
            from { text-shadow: 0 0 10px ${selectedTheme.color}80; }
            to { text-shadow: 0 0 20px ${selectedTheme.color}, 0 0 30px ${selectedTheme.color}80; }
        }
        
        .theme-emoji {
            font-size: 5em;
            margin: 30px 0;
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        
        .theme-description {
            font-size: 1.3em;
            line-height: 1.6;
            margin: 30px auto;
            color: #ddd;
            background: rgba(0,0,0,0.4);
            padding: 25px;
            border-radius: 20px;
            border-left: 5px solid ${selectedTheme.color};
            max-width: 600px;
            backdrop-filter: blur(10px);
        }
        
        .interactive-area {
            margin: 40px 0;
            padding: 30px;
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            border: 2px dashed ${selectedTheme.color}80;
            position: relative;
            overflow: hidden;
        }
        
        .interactive-area::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                45deg,
                transparent,
                ${selectedTheme.color}20,
                transparent
            );
            animation: shine 3s infinite linear;
        }
        
        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }
        
        .sound-section {
            margin: 30px 0;
            padding: 25px;
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            border: 1px solid ${selectedTheme.color}40;
        }
        
        .sound-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        button {
            background: ${selectedTheme.color};
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 200px;
            justify-content: center;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px ${selectedTheme.color}80;
        }
        
        .surprise-button {
            background: linear-gradient(45deg, ${selectedTheme.color}, #ff0055);
            margin: 20px 0;
            animation: wiggle 2s infinite;
        }
        
        @keyframes wiggle {
            0%, 100% { transform: rotate(0); }
            25% { transform: rotate(-2deg); }
            75% { transform: rotate(2deg); }
        }
        
        .message {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid ${selectedTheme.color};
            display: none;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
        
        .counter {
            font-size: 2em;
            color: ${selectedTheme.color};
            margin: 20px 0;
            font-family: monospace;
        }
        
        .particle {
            position: absolute;
            pointer-events: none;
            border-radius: 50%;
            animation: particleFloat 1s forwards;
        }
        
        @keyframes particleFloat {
            to {
                transform: translate(var(--tx), var(--ty)) rotate(var(--r));
                opacity: 0;
            }
        }
        
        footer {
            margin-top: 50px;
            color: #888;
            font-size: 12px;
            border-top: 1px solid #333;
            padding-top: 20px;
            width: 100%;
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .theme-emoji {
                font-size: 3em;
            }
            
            .theme-description {
                font-size: 1em;
                padding: 15px;
            }
            
            button {
                min-width: 150px;
                padding: 10px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="ai-badge">ü§ñ –ó–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ AI | –¢–µ–º–∞: ${theme}</div>
    
    <div class="container">
        <div class="theme-emoji">${selectedTheme.emoji}</div>
        <h1>${selectedTheme.title}</h1>
        
        <div class="theme-description">
            <p><strong>–¢–µ–º–∞ AI-–≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó:</strong> "${theme}"</p>
            <p>‚ú® –¶—è —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –±—É–ª–∞ —Å—Ç–≤–æ—Ä–µ–Ω–∞ —à—Ç—É—á–Ω–∏–º —ñ–Ω—Ç–µ–ª–µ–∫—Ç–æ–º —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –¥–ª—è –∂–∞—Ä—Ç—ñ–≤–ª–∏–≤–æ—ó –ø–∞—Å—Ç–∫–∏.</p>
            <p>üéØ –í—Å—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –∞–¥–∞–ø—Ç–æ–≤–∞–Ω—ñ –ø—ñ–¥ –æ–±—Ä–∞–Ω—É —Ç–µ–º–∞—Ç–∏–∫—É.</p>
            <p>‚ö° –ù–∞—Ç–∏—Å–∫–∞–π—Ç–µ –∫–Ω–æ–ø–∫–∏ —Ç–∞ –≤–∑–∞—î–º–æ–¥—ñ–π—Ç–µ –∑ –µ–ª–µ–º–µ–Ω—Ç–∞–º–∏ –¥–ª—è —Å—é—Ä–ø—Ä–∏–∑—ñ–≤!</p>
        </div>
        
        <div class="interactive-area">
            <h2>üí´ –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞ –∑–æ–Ω–∞</h2>
            <p style="margin: 15px 0; color: #aaa;">–ö–ª—ñ–∫–∞–π—Ç–µ –≤ –±—É–¥—å-—è–∫–æ–º—É –º—ñ—Å—Ü—ñ –¥–ª—è –µ—Ñ–µ–∫—Ç—ñ–≤</p>
            <div class="counter" id="clickCounter">–ö–ª—ñ–∫—ñ–≤: 0</div>
        </div>
        
        ${soundUrl ? `
        <div class="sound-section">
            <h3>üéµ –ó–≤—É–∫–æ–≤–∏–π —Å—É–ø—Ä–æ–≤—ñ–¥</h3>
            <audio id="themeAudio" preload="auto">
                <source src="${soundUrl}" type="audio/mp3">
            </audio>
            <div class="sound-controls">
                <button onclick="playSound()">
                    <span>‚ñ∂Ô∏è</span> –í—ñ–¥—Ç–≤–æ—Ä–∏—Ç–∏ –∑–≤—É–∫
                </button>
                <button onclick="stopSound()" style="background: #555;">
                    <span>‚èπÔ∏è</span> –ó—É–ø–∏–Ω–∏—Ç–∏
                </button>
                <button onclick="playRandomSound()" class="surprise-button">
                    <span>üé≤</span> –í–∏–ø–∞–¥–∫–æ–≤–∏–π –µ—Ñ–µ–∫—Ç
                </button>
            </div>
        </div>
        ` : '<p style="color: #777; margin: 30px 0;">üîá –ó–≤—É–∫ –Ω–µ –¥–æ–¥–∞–Ω–æ –¥–æ —Ü—ñ—î—ó —Ç–µ–º–∏</p>'}
        
        <button class="surprise-button" onclick="showSurprise()">
            <span>üéÅ</span> –û—Ç—Ä–∏–º–∞—Ç–∏ —Å—é—Ä–ø—Ä–∏–∑!
        </button>
        
        <button onclick="startConfetti()" style="background: linear-gradient(45deg, #ff0055, #9d00ff); margin-top: 10px;">
            <span>üéâ</span> –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –∫–æ–Ω—Ñ–µ—Ç—ñ
        </button>
    </div>
    
    <div class="message" id="surpriseMessage"></div>
    
    <footer>
        <p>–°—Ç–≤–æ—Ä–µ–Ω–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é AI Gemini Flash 2.5 | ${new Date().toLocaleString('uk-UA')}</p>
        <p style="color: #666; margin-top: 5px;">‚ö†Ô∏è –¶—è —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –º–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω—ñ –µ—Ñ–µ–∫—Ç–∏</p>
    </footer>
    
    <script>
        let clickCount = 0;
        const audio = document.getElementById('themeAudio');
        const messageEl = document.getElementById('surpriseMessage');
        const counterEl = document.getElementById('clickCounter');
        
        document.addEventListener('click', function(e) {
            // –õ—ñ—á–∏–ª—å–Ω–∏–∫ –∫–ª—ñ–∫—ñ–≤
            clickCount++;
            if (counterEl) counterEl.textContent = \`–ö–ª—ñ–∫—ñ–≤: \${clickCount}\`;
            
            // –ï—Ñ–µ–∫—Ç —á–∞—Å—Ç–∏–Ω–æ–∫
            createParticle(e.clientX, e.clientY);
            
            // –í–∏–ø–∞–¥–∫–æ–≤—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
            if (clickCount % 5 === 0) {
                showMessage('–í–∏ –∞–∫—Ç–∏–≤–Ω—ñ! –ü—Ä–æ–¥–æ–≤–∂—É–π—Ç–µ!', 'info');
            }
        });
        
        function createParticle(x, y) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            
            const size = Math.random() * 10 + 5;
            const color = getComputedStyle(document.documentElement)
                .getPropertyValue('--ai-color') || '#9d00ff';
            
            particle.style.cssText = \`
                width: \${size}px;
                height: \${size}px;
                background: \${color};
                left: \${x}px;
                top: \${y}px;
                --tx: \${Math.random() * 100 - 50}px;
                --ty: \${Math.random() * 100 - 50}px;
                --r: \${Math.random() * 360}deg;
            \`;
            
            document.body.appendChild(particle);
            
            setTimeout(() => particle.remove(), 1000);
        }
        
        function playSound() {
            if (audio) {
                audio.currentTime = 0;
                audio.play().catch(e => {
                    showMessage('–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥—Ç–≤–æ—Ä–∏—Ç–∏ –∑–≤—É–∫', 'error');
                });
            }
        }
        
        function stopSound() {
            if (audio) audio.pause();
        }
        
        function playRandomSound() {
            playSound();
            setTimeout(() => {
                showMessage('üé≤ –í–∏–ø–∞–¥–∫–æ–≤–∏–π –µ—Ñ–µ–∫—Ç –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ!', 'success');
                createExplosionEffect();
            }, 500);
        }
        
        function showSurprise() {
            const surprises = [
                'üéâ –í—ñ—Ç–∞—î–º–æ! –í–∏ –∑–Ω–∞–π—à–ª–∏ —Ç–∞—î–º–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç!',
                '‚ú® –ú–∞–≥—ñ—è AI –ø—Ä–∞—Ü—é—î –Ω–∞ –ø–æ–≤–Ω—É!',
                'üé≠ –ù–µ—Å–ø–æ–¥—ñ–≤–∞–Ω–∫–∞! –û—á—ñ–∫—É–π—Ç–µ —â–µ –±—ñ–ª—å—à–µ —Å—é—Ä–ø—Ä–∏–∑—ñ–≤!',
                'ü§ñ –®–Ü —Å—Ö–≤–∞–ª—é—î –≤–∞—à—É —Ü—ñ–∫–∞–≤—ñ—Å—Ç—å!',
                'üí´ –ï—Ñ–µ–∫—Ç –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω–∫–∏ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ!'
            ];
            
            const randomSurprise = surprises[Math.floor(Math.random() * surprises.length)];
            showMessage(randomSurprise, 'success');
            
            // –í—ñ–∑—É–∞–ª—å–Ω–∏–π –µ—Ñ–µ–∫—Ç
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    createParticle(
                        Math.random() * window.innerWidth,
                        Math.random() * window.innerHeight
                    );
                }, i * 50);
            }
        }
        
        function startConfetti() {
            showMessage('üéä –ö–æ–Ω—Ñ–µ—Ç—ñ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ!', 'success');
            
            const colors = ['#ff0055', '#9d00ff', '#00ff99', '#00ffff', '#ffcc00'];
            
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    const x = Math.random() * window.innerWidth;
                    const y = Math.random() * window.innerHeight;
                    const color = colors[Math.floor(Math.random() * colors.length)];
                    
                    const confetti = document.createElement('div');
                    confetti.style.cssText = \`
                        position: fixed;
                        width: 10px;
                        height: 10px;
                        background: \${color};
                        left: \${x}px;
                        top: \${y}px;
                        border-radius: 2px;
                        pointer-events: none;
                        z-index: 9999;
                        animation: fall \${Math.random() * 2 + 1}s linear forwards;
                    \`;
                    
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 2000);
                }, i * 30);
            }
            
            // –î–æ–¥–∞—î–º–æ —Å—Ç–∏–ª—å –¥–ª—è –∞–Ω—ñ–º–∞—Ü—ñ—ó –ø–∞–¥—ñ–Ω–Ω—è
            if (!document.getElementById('confetti-style')) {
                const style = document.createElement('style');
                style.id = 'confetti-style';
                style.textContent = \`
                    @keyframes fall {
                        to {
                            transform: translateY(100vh) rotate(360deg);
                            opacity: 0;
                        }
                    }
                \`;
                document.head.appendChild(style);
            }
        }
        
        function createExplosionEffect() {
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    createParticle(
                        window.innerWidth / 2,
                        window.innerHeight / 2
                    );
                }, i * 20);
            }
        }
        
        function showMessage(text, type) {
            if (!messageEl) return;
            
            messageEl.textContent = text;
            messageEl.style.display = 'block';
            messageEl.style.borderLeftColor = type === 'error' ? '#ff0055' : 
                                           type === 'success' ? '#00ff99' : '#9d00ff';
            
            setTimeout(() => {
                messageEl.style.display = 'none';
            }, 3000);
        }
        
        // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫
        setTimeout(() => {
            showMessage('ü§ñ AI —Å–∞–π—Ç –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ! –ì–æ—Ç–æ–≤–∏–π –¥–æ –≤–∑–∞—î–º–æ–¥—ñ—ó.', 'info');
            
            if (audio && Math.random() > 0.7) {
                setTimeout(() => {
                    audio.volume = 0.3;
                    audio.play().catch(() => {});
                }, 1000);
            }
        }, 1000);
        
        // –î–∏–Ω–∞–º—ñ—á–Ω–∞ –∑–º—ñ–Ω–∞ –∫–æ–ª—å–æ—Ä—ñ–≤
        document.documentElement.style.setProperty('--ai-color', '${selectedTheme.color}');
    </script>
</body>
</html>
    `;
}

// ... (—ñ–Ω—à—ñ —Ñ—É–Ω–∫—Ü—ñ—ó —Ç–∞ –º–∞—Ä—à—Ä—É—Ç–∏ –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –±–µ–∑ –∑–º—ñ–Ω) ...

const PORT = 3000;
http.listen(PORT, '0.0.0.0', () => {
    console.log(`Server running on http://localhost:${PORT}`);
    console.log(`Admin: /admin.html | Watch: /watch.html | Victim: /victim.html?id=...`);
    console.log(`AI Sites (Gemini): /cust.html/[site-id]`);
    console.log(`Using Gemini Flash 2.5 for AI generation`);
});
[file content end]
